{% extends 'pybb/base.html' %}
{% load pybb_extras %}
{% load i18n %}
{% load humanize %}
{% load wlprofile %}
{% load custom_date %}

{% block title %}
{{ forum.name }} - {{ block.super }}
{% endblock %}

{% block extra_head %}
<link rel="alternate" type="application/atom+xml" title="Latest Posts on forum '{{ forum.name }}'" href="{% url pybb_feed "posts" %}{{forum.id}}/"  />
<link rel="alternate" type="application/atom+xml" title="Latest Topics on forum '{{ forum.name }}'" href="{% url pybb_feed "topics" %}{{forum.id}}/" />
{{ block.super }}
{% endblock %}

{% block content %}
<h1>Forum: {{ forum }}</h1>

<div class="blogEntry">
	<a href="{% url pybb_index %}">Forums</a> &#187; 
	{% pybb_link forum.category %} &#187; 
	{{ forum }}
	<br /><br />
	<button class="posRight" onclick="window.location.href='{% url pybb_add_topic forum.id %}';">
		<img src="{{MEDIA_URL}}/forum/img/new_topic.png" alt ="{% trans "New Topic" %}" class="middle" />
		<span class="middle">{% trans "New Topic" %}</span>
	</button>
	{% pybb_pagination _('Topics') %}
	<br /><br />

	<table class="forum">
		<thead>
			<tr>
				<td class="forumIcon"></td>
				<td class="forumTitle small">Title</td>
				<td class="forumCount"></td>
				<td class="lastPost small">Last Post by</td>
			</tr>
		</thead>
		<tbody>
	{% for topic in topics %}
		<tr class="{% cycle 'odd' 'even' %}">
			<td class="forumIcon center">
				{% if topic|pybb_has_unreads:user %}
				<img src="{{ MEDIA_URL }}/forum/img/doc_big_work_star.png" style="margin: 0px;" alt="" class="middle" />
				{% else %}
				<img src="{{ MEDIA_URL }}/forum/img/doc_big_work.png" style="margin: 0px;" alt="" class="middle" />
				{% endif %}
			</td>
			<td class="forumTitle">
				{% if topic.sticky %}<img src="{{MEDIA_URL}}/forum/img/sticky.png" alt="Sticky" title="Sticky" />{% endif %}
				{% if topic.closed %}<img src="{{MEDIA_URL}}/forum/img/closed.png" alt="Closed" title="Closed" />{% endif %}
				<a href="{{ topic.get_absolute_url }}">{{ topic.name }}</a><br />
				<span class="small">Created by {{ topic.user|user_link }} on {{ topic.created|custom_date:user }}</span>
			</td>
			<td class="forumCount center small" style="width: 120px;">
				Posts: {{ topic.post_count }}<br/>
				Views: {{ topic.views }}
			</td>
			<td class="lastPost">
				{%if topic.last_post %}
				{{ topic.last_post.user|user_link }}<br />
				<span class="small">on {{ topic.last_post.created|custom_date:user }}</span>
				{% endif %}
			</td>
		</tr>
	{% endfor %}
		</tbody>
	</table>

	<br />
	<button class="posRight" onclick="window.location.href='{% url pybb_add_topic forum.id %}';">
		<img src="{{MEDIA_URL}}/forum/img/new_topic.png" alt ="{% trans "New Topic" %}" class="middle" />
		<span class="middle">{% trans "New Topic" %}</span>
	</button>
	{% pybb_pagination _('Topics') %}
	<br />
</div>

<div class="center green">
	<img src="{{MEDIA_URL}}/forum/img/doc_big_work_star.png" alt="" class="middle" />
	= Unread posts
	<img src="{{MEDIA_URL}}/forum/img/doc_big_work.png" alt="" class="middle" /> 
	= No unread posts
</div>
{% endblock %}

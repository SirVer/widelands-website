{% extends 'base.html' %}

{% block extra_head %}
<link rel="stylesheet" type="text/css" media="all" href="{{ MEDIA_URL }}css/search.css" />
{{block.super}}
{% endblock %}

{% block content %}
    <h2>Search</h2>

    <div class="blogEntry">
        <ul>
            <li>The Search is case insentive.</li>
            <li>Search terms get stemmed, e.g. 'Tribes' find also 'tribe', 'mining' finds also 'Mine' and 'miner'.</li>
            <li>Providing more than one word, the words get ANDed, e.g. all words must be in a topics name.</li>
        </ul>
    <form method="get" action=".">
        <table>
            {{ form.as_table }}
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="submit" value="Search">
                </td>
            </tr>
        </table>
        {% if query %}
            <h2>Results</h2>
            {% for result in object_list %}
                {% for section, section_entries in result.items %}
                    {% if section == "maps" and section_entries|length > 0 %}
                        <h3> Maps:</h3>
                        <ul>
                            {% for map in section_entries %}
                                {% include "search/includes/maps.html" %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if section == "topics" and section_entries|length > 0 %}
                        <h3> Topics: </h3>
                        <ul>
                            {% for topic in section_entries %}
                                {% include "search/includes/topics.html" %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if section == "posts" and section_entries|length > 0 %}
                        <h3> Posts: </h3>
                        <ul>
                            {% for post in section_entries %}
                                {% include "search/includes/posts.html" %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if section == "workers" and section_entries|length > 0 %}
                        <h3> Workers: </h3>
                        <ul>
                            {% for worker in section_entries %}
                                {% include "search/includes/workers.html" %}
                            {% endfor %}
                        </ul>
                    {% endif %}
                {% endfor %}
            {% endfor %}
            {% if page_obj.has_previous or page_obj.has_next %}
                <div>
                    {% if page_obj.has_previous %}<a href="?q={{ query }}&amp;page={{ page_obj.previous_page_number }}">{% endif %}&laquo; Previous{% if page_obj.has_previous %}</a>{% endif %}
                    |
                    {% if page_obj.has_next %}<a href="?q={{ query }}&amp;page={{ page_obj.next_page_number }}">{% endif %}Next &raquo;{% if page_obj.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
    </form>
    </div>
{% endblock %}
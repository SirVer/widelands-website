{% extends 'base.html' %}

{% block content %}
    <h2>Search</h2>

    <div class="blogEntry">
    <p>The Search is case insentive. Search Words get stemmed (e.g.: 'Tribes' find also 'Tribe').
    Providing more than one word, the words get ANDed, so all words must be in a topic.</p>
    <form method="get" action=".">
        <table>
            {{ form.as_table }}
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="submit" value="Search">
                </td>
            </tr>
        </table>
        {% if query %}
            <h2>Results</h2>
            {% for result in object_list %}
                {% for section, entry in result.items %}
                    {% if section == "maps" and entry|length > 0 %}
                        <h3> Maps:</h3>
                        <ul>
                            {% for map in entry %}
                            <li><a href=" {{ map.object.get_absolute_url }}">{{ map.object.name }}</a> by {{ map.object.author}} at {{map.object.pub_date}}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if section == "topics" and entry|length > 0 %}
                        <h3> Topics: </h3>
                        <ul>
                            {% for topic in entry %}
                            <li><a href=" {{ topic.object.get_absolute_url }}">{{ topic.object.name }}</a><span class="small"> @ </span> 
                                Forum <a href="{{ topic.object.forum.get_absolute_url }}">{{ topic.object.forum }}</a>
                                by {{topic.object.user}},
                                {{topic.object.updated}}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    {% if section == "posts" and entry|length > 0 %}
                        <h3> Posts: </h3>
                        <ul>
                            {% for post in entry %}
                            <li><a href=" {{ post.object.get_absolute_url }}">Post by {{ post.object.user }}</a><span class="small"> @ </span>
                             Topic <a href="{{ post.object.topic.get_absolute_url }}">{{ post.object.topic }}</a><span class="small"> @ </span>
                             Forum <a href="{{ post.object.topic.forum.get_absolute_url }}">{{ post.object.topic.forum }}</a>,
                             {{post.object.created}}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                {% endfor %}
            {% endfor %}

            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
    </form>
    </div>
{% endblock %}